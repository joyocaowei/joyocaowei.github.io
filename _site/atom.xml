<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>joyocaowei</title>
 <link href="http://joyocaowei.github.io/" rel="self"/>
 <link href="http://joyocaowei.github.io"/>
 <updated>2014-08-28T00:29:15+08:00</updated>
 <id>http://joyocaowei.github.io</id>
 <author>
   <name>Cao, Wei</name>
   <email>joyocaowei at gmail.com</email>
 </author>

 
 <entry>
   <title>awk的简单使用</title>
   <link href="http://joyocaowei.github.io/linux-awk/"/>
   <updated>2014-08-27T00:00:00+08:00</updated>
   <id>http://joyocaowei.github.io/Linux-awk</id>
   <content type="html">&lt;h4&gt;Case 1 - Please aggregate ID if the Department is the same&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;cat file1&lt;/code&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;ADM,515356&lt;br/&gt;
FX,320123&lt;br/&gt;
FX,539201&lt;br/&gt;
Cloud,690392&lt;br/&gt;
ADM,539230&lt;br/&gt;
FX,859302&lt;br/&gt;
Cloud,689493&lt;/p&gt;&lt;/blockquote&gt;

&lt;pre&gt;&lt;code class=&quot;bash  &quot;&gt;awk -F&#39;,&#39; &#39;{a[$1]=a[$1]($2&quot;^&quot;)}END{for(i in a)printf &quot;%s,%s\n&quot;, i,a[i]}&#39; file1 | sed &#39;s/\^$//&#39;  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;The output is:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Cloud,690392^689493&lt;br/&gt;
FX,320123^539201^859302&lt;br/&gt;
ADM,515356^539230&lt;/p&gt;&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h4&gt;Case 2 - reverse the operation done in case 1&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;cat file2&lt;/code&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;ADM,515356^539230&lt;br/&gt;
Cloud,689493^690392&lt;br/&gt;
FX,320123^539201^859302&lt;/p&gt;&lt;/blockquote&gt;

&lt;pre&gt;&lt;code class=&quot;bash  &quot;&gt;awk -F&#39;,&#39; &#39;{split($2,a,&quot;^&quot;); for(i in a) printf &quot;%s,%s\n&quot;, $1,a[i]}&#39; file2  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;You will get the result:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;ADM,539230&lt;br/&gt;
ADM,515356&lt;br/&gt;
Cloud,690392&lt;br/&gt;
Cloud,689493&lt;br/&gt;
FX,539201&lt;br/&gt;
FX,859302&lt;br/&gt;
FX,320123&lt;/p&gt;&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h4&gt;Case 3 - calculate the sales percentage&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;cat file3&lt;/code&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Eastern Country,3000000&lt;br/&gt;
Eastern Country,5000000&lt;br/&gt;
Western Country,1000000&lt;br/&gt;
Northern Country,2000000&lt;br/&gt;
Southern Country,3000000&lt;br/&gt;
Northern Country,1000000&lt;/p&gt;&lt;/blockquote&gt;

&lt;pre&gt;&lt;code class=&quot;bash  &quot;&gt;awk -F&#39;,&#39; &#39;{a[$1]+=$2;b+=$2}END{for(i in a)printf &quot;%s,%s,%0.3f\n&quot;, i,a[i],a[i]/b}&#39; file3  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;You can get the result:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Eastern Country,8000000,0.533&lt;br/&gt;
Western Country,1000000,0.067&lt;br/&gt;
Northern Country,3000000,0.200&lt;br/&gt;
Southern Country,3000000,0.200&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Written this article with &lt;a href=&quot;https://stackedit.io/&quot;&gt;StackEdit&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 
</feed>